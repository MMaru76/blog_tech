(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{504:function(t,a,e){"use strict";e.r(a);var s=e(4),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"_1-はじめに"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-はじめに"}},[t._v("#")]),t._v(" 1. はじめに")]),t._v(" "),e("p",[t._v("皆さんも一度は､｢なんだこのデフォルトAPIキーは？､てか要らないだろ!!!消しちゃえ｣って言って消してしまった事はありますでしょうか？(僕は"),e("strong",[t._v("勿論")]),t._v("あります)")]),t._v(" "),e("p",[t._v("そもそも何で消したのか？")]),t._v(" "),e("blockquote",[e("p",[t._v("Datadog を AWS に入れた際に､空白の API キーがあったので消しました｡(反省はしていますが､空白なのが悪い｡)")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://gyazo.com/6708c633d709969f1d9a76c255cdfa29",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.gyazo.com/6708c633d709969f1d9a76c255cdfa29.png",alt:"Image from Gyazo"}}),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("弁明するとしたら｡｢つい･･･空白だったから｡｣")]),t._v(" "),e("p",[t._v("これによって起きてしまった事｡"),e("br"),t._v("\n完全にインスタンスからデータを取得出来なかった｡")]),t._v(" "),e("blockquote",{staticClass:"twitter-tweet",attrs:{"data-dnt":"true","data-theme":"dark"}},[e("p",{attrs:{lang:"ja",dir:"ltr"}},[t._v("草 "),e("a",{attrs:{href:"https://t.co/dlChe56Y3d"}},[t._v("pic.twitter.com/dlChe56Y3d")])]),t._v("— まるちゃんLv24@DevOps (@M_Maru76) "),e("a",{attrs:{href:"https://twitter.com/M_Maru76/status/1302583375799042048?ref_src=twsrc%5Etfw"}},[t._v("September 6, 2020")])]),t._v(" "),e("script",{attrs:{async:"",src:"https://platform.twitter.com/widgets.js",charset:"utf-8"}}),t._v(" "),e("h2",{attrs:{id:"_2-概要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-概要"}},[t._v("#")]),t._v(" 2. 概要")]),t._v(" "),e("p",[t._v("前フリが長くなりましたが､ここで実施する事としては以下の3点")]),t._v(" "),e("ul",[e("li",[t._v("【API キー】の再生性")]),t._v(" "),e("li",[t._v("既存インスタンスにて【API キー】の再設定")]),t._v(" "),e("li",[t._v("動作確認")])]),t._v(" "),e("h2",{attrs:{id:"_3-【api-キー】の再生性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-【api-キー】の再生性"}},[t._v("#")]),t._v(" 3. 【API キー】の再生性")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://app.datadoghq.com/account/settings#api",target:"_blank",rel:"noopener noreferrer"}},[t._v("Datadog APIs ページ"),e("OutboundLink")],1)]),t._v(" "),e("ol",[e("li",[t._v("Datadogにログイン")]),t._v(" "),e("li",[t._v("【Integrations】=>【"),e("a",{attrs:{href:"https://app.datadoghq.com/account/settings#api",target:"_blank",rel:"noopener noreferrer"}},[t._v("APIs"),e("OutboundLink")],1),t._v("】をクリックしていいどう\n"),e("ul",[e("li",[e("a",{attrs:{href:"https://gyazo.com/3241bd3d20b25c045d4ae9c77bf178a7",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.gyazo.com/3241bd3d20b25c045d4ae9c77bf178a7.png",alt:"Image from Gyazo"}}),e("OutboundLink")],1)])])]),t._v(" "),e("li",[t._v("【API Keys】 にて\n"),e("ul",[e("li",[t._v("『New API Key』: 任意の名前を入力")]),t._v(" "),e("li",[t._v("『Create API Key』: クリックして作成")])])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://gyazo.com/247635ff679cc5ac59fbe9f763405bb4",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.gyazo.com/247635ff679cc5ac59fbe9f763405bb4.png",alt:"Image from Gyazo"}}),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"_4-既存インスタンスにて【api-キー】の再設定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-既存インスタンスにて【api-キー】の再設定"}},[t._v("#")]),t._v(" 4. 既存インスタンスにて【API キー】の再設定")]),t._v(" "),e("p",[t._v("複数のインスタンスに対して設定してしまった場合は､諦めて頑張ってください｡")]),t._v(" "),e("ol",[e("li",[t._v("｢"),e("RouterLink",{attrs:{to:"/blogs/datadog/api_key_regeneration.html#_3-【api-キー】の再生性"}},[t._v("3.【API キー】の再生性")]),t._v("｣にて生成した『Key』をコピー\n"),e("ul",[e("li",[t._v("紫色の部分にカーソルを当てると『Key』が表示される")])])],1),t._v(" "),e("li",[t._v("該当インスタンスに SSH 接続")]),t._v(" "),e("li",[e("code",[t._v("datadog.yaml")]),t._v(" の10行目で新しい『Key』に置き換える")])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/datadog-agent/datadog.yaml")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("行目 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" api_key: XXXXXXXXXXXXXXXXXXXXXXXXX\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("ol",{attrs:{start:"4"}},[e("li",[t._v("datadog-agent サービスの再起動")])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl restart datadog-agent")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ol",{attrs:{start:"5"}},[e("li",[t._v("datadog-agent サービスの稼働確認")])]),t._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl status datadog-agent")]),t._v("\n\n● datadog-agent.service - Datadog Agent\n   Loaded: loaded "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/usr/lib/systemd/system/datadog-agent.service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" enabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" vendor preset: disabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   Active: active "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("running"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" since Sun YYYY-MM-DD hh:mm:ss JST"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 1h 53min ago\n Main PID: XXX "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   CGroup: /system.slice/datadog-agent.service\n           └─XXX /opt/datadog-agent/bin/agent/agent run -p /opt/datadog-agent/run/agent.pid\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])]),e("h2",{attrs:{id:"_5-動作確認"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-動作確認"}},[t._v("#")]),t._v(" 5. 動作確認")]),t._v(" "),e("p",[t._v("実際に作成したダッシュボードなどでデータが取得出来ているか確認を実施")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("system.cpu.user")]),t._v(" を取得している場合は､下記のように再度取得が開始する\n"),e("a",{attrs:{href:"https://gyazo.com/65080281d6f281961a2e6073cb1f1eed",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.gyazo.com/65080281d6f281961a2e6073cb1f1eed.png",alt:"Image from Gyazo"}}),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[t._v("ロードアベレージやメモリなどは自動的に上手く繋げられる模様\n"),e("a",{attrs:{href:"https://gyazo.com/b1258165450a90e140cc12493915980e",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://i.gyazo.com/b1258165450a90e140cc12493915980e.png",alt:"Image from Gyazo"}}),e("OutboundLink")],1)])])]),t._v(" "),e("h2",{attrs:{id:"_6-さいごに"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-さいごに"}},[t._v("#")]),t._v(" 6. さいごに")]),t._v(" "),e("p",[t._v("名前が無いからってリソースを消しちゃ駄目｡")])])}),[],!1,null,null,null);a.default=r.exports}}]);