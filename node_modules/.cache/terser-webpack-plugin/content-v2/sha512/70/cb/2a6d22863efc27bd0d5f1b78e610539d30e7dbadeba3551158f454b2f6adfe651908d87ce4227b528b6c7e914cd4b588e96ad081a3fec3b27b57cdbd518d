{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{500:function(t,s,a){\"use strict\";a.r(s);var e=a(4),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"_1-はじめに\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-はじめに\"}},[t._v(\"#\")]),t._v(\" 1. はじめに\")]),t._v(\" \"),a(\"hr\"),t._v(\" \"),a(\"p\",[t._v(\"この記事を投稿する10日前にいつも通り朝活として､\"),a(\"a\",{attrs:{href:\"https://youtu.be/PGAaBrOjbw4\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"YouTube のサバワチャンネル\"),a(\"OutboundLink\")],1),t._v(\"で動画を見ていたら､『コンテナログを S3 に直接出力!』というパワーワードを知ってしまって･･･これはやらなきゃ!!!っという事で実際にやって書きました｡\")]),t._v(\" \"),a(\"blockquote\",{staticClass:\"twitter-tweet\"},[a(\"p\",{attrs:{lang:\"ja\",dir:\"ltr\"}},[t._v(\"AWSが｢Fluent Bit がコンテナログをルーティングする送信先として Amazon S3 をサポート｣らしいですよ｡\"),a(\"a\",{attrs:{href:\"https://t.co/m6uYG1Uejg\"}},[t._v(\"https://t.co/m6uYG1Uejg\")])]),t._v(\"— まるちゃんLv24@DevOps (@M_Maru76) \"),a(\"a\",{attrs:{href:\"https://twitter.com/M_Maru76/status/1316897982659223552?ref_src=twsrc%5Etfw\"}},[t._v(\"October 16, 2020\")])]),t._v(\" \"),a(\"script\",{attrs:{async:\"\",src:\"https://platform.twitter.com/widgets.js\",charset:\"utf-8\"}}),t._v(\" \"),a(\"p\",[t._v(\"CloudWatch のログに書き込みを行うと0.76USD/GB掛かって辛いですよね･･･\")]),t._v(\" \"),a(\"h2\",{attrs:{id:\"_2-【iam-ロール】編\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-【iam-ロール】編\"}},[t._v(\"#\")]),t._v(\" 2. 【IAM ロール】編\")]),t._v(\" \"),a(\"hr\"),t._v(\" \"),a(\"ol\",[a(\"li\",[a(\"a\",{attrs:{href:\"https://console.aws.amazon.com/iam/home#/roles\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"IAMロールのコンソール\"),a(\"OutboundLink\")],1),t._v(\"にアクセスして【ecsTaskExecutionRole】を検索して選択\\n\"),a(\"ul\",[a(\"li\",[t._v(\"別のタスクロールの場合は､そちらを指定\")])])]),t._v(\" \"),a(\"li\",[t._v(\"【ecsTaskExecutionRole】のロールにて､【インラインポリシー】を選択して下記コードを追加\")])]),t._v(\" \"),a(\"ul\",[a(\"li\",[t._v(\"内容としては､｢S3に書き込み｣です｡\")])]),t._v(\" \"),a(\"div\",{staticClass:\"language-json line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Version\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"2012-10-17\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Statement\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Effect\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"Allow\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Action\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"s3:PutObject\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Resource\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"*\"')]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),a(\"br\")])]),a(\"ul\",[a(\"li\",[t._v(\"実際に追加された際の画面\")])]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/c500341c18c13372d6b38db4297f79bf\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/c500341c18c13372d6b38db4297f79bf.png\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h2\",{attrs:{id:\"_3-【ecs-タスク定義】編\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-【ecs-タスク定義】編\"}},[t._v(\"#\")]),t._v(\" 3. 【ECS タスク定義】編\")]),t._v(\" \"),a(\"hr\"),t._v(\" \"),a(\"ol\",[a(\"li\",[t._v(\"ECS のコンソールページにアクセス\")]),t._v(\" \"),a(\"li\",[t._v(\"【タスク定義】を選択\")]),t._v(\" \"),a(\"li\",[t._v(\"既存のタスク定義を選択\")]),t._v(\" \"),a(\"li\",[t._v(\"【新しいリビジョンの作成】を選択\")])]),t._v(\" \"),a(\"h3\",{attrs:{id:\"_3-1-【ログルーターの統合】-にて\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-1-【ログルーターの統合】-にて\"}},[t._v(\"#\")]),t._v(\" 3.1. 【ログルーターの統合】 にて\")]),t._v(\" \"),a(\"p\",[t._v(\"ログルーターの統合にて【FireLens の統合を有効にする】にチェックを入れて､編集せずに【適用】を選択\")]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/17972adc30b78d0270c48670b5650048\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/17972adc30b78d0270c48670b5650048.png\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h3\",{attrs:{id:\"_3-2-【コンテナの定義】-にて\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-【コンテナの定義】-にて\"}},[t._v(\"#\")]),t._v(\" 3.2. 【コンテナの定義】 にて\")]),t._v(\" \"),a(\"table\",[a(\"thead\",[a(\"tr\",[a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"項目\")]),t._v(\" \"),a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"値\")])])]),t._v(\" \"),a(\"tbody\",[a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"LogS3-lxc\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"Myサービスコンテナ側\")])]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"log_router\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"AWS for Fluent Bit コンテナ側\")])])])]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/53784d01b0b0033db7a492df9493eb5b\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/53784d01b0b0033db7a492df9493eb5b.png\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h4\",{attrs:{id:\"_3-2-1-【logs3-lxc】-コンテナ側\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-1-【logs3-lxc】-コンテナ側\"}},[t._v(\"#\")]),t._v(\" 3.2.1. 【LogS3-lxc】 コンテナ側\")]),t._v(\" \"),a(\"p\",[t._v(\"『ストレージとログ』の所にて下記の用に変更を実施\")]),t._v(\" \"),a(\"ol\",[a(\"li\",[t._v(\"ログドライバー :【awslogs】から【awsfirelens】切り替え\")]),t._v(\" \"),a(\"li\",[t._v(\"ログオプション : 下記テーブルを参考\\n\"),a(\"ul\",[a(\"li\",[t._v(\"region : ECS サービスを動かすリージョンを指定\")]),t._v(\" \"),a(\"li\",[t._v(\"bucket : 自分で作成したバケット名を記述\")]),t._v(\" \"),a(\"li\",[t._v(\"total_file_size : 1M だと動かなった模様\")])])])]),t._v(\" \"),a(\"table\",[a(\"thead\",[a(\"tr\",[a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"KEY\")]),t._v(\" \"),a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"VALUE\")])])]),t._v(\" \"),a(\"tbody\",[a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"Name\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"s3\")])]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"region\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"ap-northeast-1\")])]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"bucket\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"tabiya-logs\")])]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"total_file_size\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"250M\")])])])]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/a9f7368fc362945a35a633c7856bbde9\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/a9f7368fc362945a35a633c7856bbde9.png\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h4\",{attrs:{id:\"_3-2-2-【log-router】-コンテナ側\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-2-【log-router】-コンテナ側\"}},[t._v(\"#\")]),t._v(\" 3.2.2. 【log_router】 コンテナ側\")]),t._v(\" \"),a(\"p\",[t._v(\"『ストレージとログ』の所にて下記の用に変更を実施\")]),t._v(\" \"),a(\"ol\",[a(\"li\",[t._v(\"ログドライバー :【awsfirelens】から【awslogs】切り替え\")]),t._v(\" \"),a(\"li\",[t._v(\"ログオプション : 下記テーブルを参考\")])]),t._v(\" \"),a(\"table\",[a(\"thead\",[a(\"tr\",[a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"KEY\")]),t._v(\" \"),a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"VALUE\")]),t._v(\" \"),a(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"用途\")])])]),t._v(\" \"),a(\"tbody\",[a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"awslogs-group\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"firelens-container\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}})]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"awslogs-region\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"ap-northeast-1\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}})]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"awslogs-stream-prefix\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"firelens\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}})]),t._v(\" \"),a(\"tr\",[a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"awslogs-create-group\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"true\")]),t._v(\" \"),a(\"td\",{staticStyle:{\"text-align\":\"center\"}})])])]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/c804fd16eafbff0773e7ed74ca040d11\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/c804fd16eafbff0773e7ed74ca040d11.png\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h4\",{attrs:{id:\"サンプル-json\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#サンプル-json\"}},[t._v(\"#\")]),t._v(\" サンプル json\")]),t._v(\" \"),a(\"ul\",[a(\"li\",[t._v(\"上の群 : log_router コンテナ\")]),t._v(\" \"),a(\"li\",[t._v(\"下の群 : ogS3-lxc コンテナ\")])]),t._v(\" \"),a(\"div\",{staticClass:\"language-json line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"executionRoleArn\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"arn:aws:iam::XXXXXXXXXXXXXXXX:role/ecsTaskExecutionRole\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"containerDefinitions\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"logConfiguration\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"logDriver\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"awslogs\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"options\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"awslogs-group\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"firelens-container\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"awslogs-region\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"ap-northeast-1\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"awslogs-create-group\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"true\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"awslogs-stream-prefix\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"firelens\"')]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"cpu\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"image\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"906394416424.dkr.ecr.ap-northeast-1.amazonaws.com/aws-for-fluent-bit:latest\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"firelensConfiguration\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"type\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"fluentbit\"')]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"essential\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"true\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"user\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"0\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"name\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"log_router\"')]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"logConfiguration\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"logDriver\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"awsfirelens\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"options\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"Name\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"s3\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"bucket\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"tabiya-logs\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"total_file_size\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"250M\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"region\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"ap-northeast-1\"')]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"portMappings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"hostPort\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"80\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"tcp\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n                    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"containerPort\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"80\")]),t._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"cpu\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"image\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"XXXXXXXXXXXXXXXX.dkr.ecr.ap-northeast-1.amazonaws.com/maruya:latest\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"essential\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"true\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"name\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"LogS3-lxc\"')]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"memory\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"512\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"taskRoleArn\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"arn:aws:iam::XXXXXXXXXXXXXXXX:role/ecsTaskExecutionRole\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"family\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"tabiya_nginx_ver\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"requiresCompatibilities\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"FARGATE\"')]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"networkMode\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"awsvpc\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"cpu\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"256\"')]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"44\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"45\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"46\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"47\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"48\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"49\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"50\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"51\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"52\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"53\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"54\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"_4-実際の画面\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-実際の画面\"}},[t._v(\"#\")]),t._v(\" 4. 実際の画面\")]),t._v(\" \"),a(\"hr\"),t._v(\" \"),a(\"p\",[t._v(\"S3の該当バケットにアクセスすると下記の階層で表示されます｡\")]),t._v(\" \"),a(\"ul\",[a(\"li\",[t._v(\"基本的には10分に一度バケットに書き込まれる\")])]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://gyazo.com/fbda386b9c6872a9c2f5944fe4f8938a\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"img\",{attrs:{src:\"https://i.gyazo.com/fbda386b9c6872a9c2f5944fe4f8938a.gif\",alt:\"Image from Gyazo\"}}),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h2\",{attrs:{id:\"_5-参考記事\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-参考記事\"}},[t._v(\"#\")]),t._v(\" 5. 参考記事\")]),t._v(\" \"),a(\"hr\"),t._v(\" \"),a(\"ul\",[a(\"li\",[a(\"a\",{attrs:{href:\"https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/userguide/using_firelens.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"AWS ドキュメント : カスタムログルーティング\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"li\",[a(\"a\",{attrs:{href:\"https://docs.fluentbit.io/manual/pipeline/outputs/s3\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Amazon S3 - Fluent Bit: Official Manual\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"li\",[a(\"a\",{attrs:{href:\"https://github.com/aws/aws-for-fluent-bit\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"aws-for-fluent-bit\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"li\",[a(\"a\",{attrs:{href:\"https://github.com/aws-samples/amazon-ecs-firelens-examples/tree/mainline/examples/fluent-bit/s3\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"amazon-ecs-firelens-examples\"),a(\"OutboundLink\")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);","extractedComments":[]}